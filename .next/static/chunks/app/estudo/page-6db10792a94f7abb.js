(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[793],{63:(e,s,a)=>{"use strict";var t=a(7260);a.o(t,"useParams")&&a.d(s,{useParams:function(){return t.useParams}}),a.o(t,"useRouter")&&a.d(s,{useRouter:function(){return t.useRouter}}),a.o(t,"useSearchParams")&&a.d(s,{useSearchParams:function(){return t.useSearchParams}})},3721:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>n});var t=a(5155),r=a(2115),c=a(63);function l(){let e=(0,c.useSearchParams)(),s=e.get("topic")||e.get("topicId"),[a,l]=(0,r.useState)(!1),[n,o]=(0,r.useState)(1500),[i,d]=(0,r.useState)(!1),[m,u]=(0,r.useState)(0),[h,x]=(0,r.useState)(s||""),[v,j]=(0,r.useState)([]),[p,N]=(0,r.useState)(""),[f,b]=(0,r.useState)(null),[S,y]=(0,r.useState)(!1);(0,r.useEffect)(()=>{g(),w()},[]),(0,r.useEffect)(()=>{s&&x(s)},[s]),(0,r.useEffect)(()=>{let e=null;return a&&n>0?e=setInterval(()=>{o(e=>e-1)},1e3):0===n&&(l(!1),i?(d(!1),o(1500)):(D(),d(!0),o(300))),()=>{e&&clearInterval(e)}},[a,n,i]);let g=async()=>{try{let e=await fetch("/api/topics");if(e.ok){let s=await e.json();j(s)}}catch(e){console.error("Erro ao carregar t\xf3picos:",e)}},w=async()=>{try{let e=new Date;e.setHours(0,0,0,0);let s=new Date(e);s.setDate(s.getDate()+1);let a=await fetch("/api/sessions?startDate=".concat(e.toISOString(),"&endDate=").concat(s.toISOString()));if(a.ok){let e=await a.json();u(e.length)}}catch(e){console.error("Erro ao carregar sess\xf5es:",e)}},D=async()=>{if(h&&f)try{let e=new Date,s=Math.floor((e.getTime()-f.getTime())/1e3/60);(await fetch("/api/sessions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({topicId:h,duration:Math.max(s,25),startedAt:f.toISOString(),endedAt:e.toISOString(),notes:p.trim()||void 0})})).ok&&(u(e=>e+1),N(""),b(null))}catch(e){console.error("Erro ao salvar sess\xe3o:",e)}},k=async()=>{if(!h)return void alert("Por favor, selecione um t\xf3pico.");if(!p.trim())return void alert("Por favor, adicione algumas notas sobre a sess\xe3o.");y(!0);try{let e=new Date,s=f||new Date(e.getTime()-15e5);if((await fetch("/api/sessions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({topicId:h,duration:25,startedAt:s.toISOString(),endedAt:e.toISOString(),notes:p.trim()})})).ok)u(e=>e+1),N(""),alert("Sess\xe3o salva com sucesso!");else throw Error("Erro ao salvar sess\xe3o")}catch(e){console.error("Erro ao salvar sess\xe3o:",e),alert("Erro ao salvar sess\xe3o. Tente novamente.")}finally{y(!1)}},E=v.find(e=>e.id===h);return(0,t.jsx)("div",{className:"container",children:(0,t.jsx)("div",{className:"row justify-content-center",children:(0,t.jsxs)("div",{className:"col-lg-8 col-md-10",children:[(0,t.jsxs)("div",{className:"text-center mb-4",children:[(0,t.jsx)("h1",{className:"display-4 fw-bold mb-3",children:"⏱️ Sess\xe3o de Estudo"}),(0,t.jsx)("p",{className:"lead text-muted",children:i?"Hora do intervalo!":"Foque nos seus estudos"})]}),(0,t.jsx)("div",{className:"card shadow-lg mb-4",children:(0,t.jsxs)("div",{className:"card-body text-center py-5",children:[(0,t.jsx)("div",{className:"display-1 font-monospace fw-bold mb-4 ".concat(i?"text-success":"text-primary"),style:{fontSize:"4rem"},children:(e=>{let s=Math.floor(e/60);return"".concat(s.toString().padStart(2,"0"),":").concat((e%60).toString().padStart(2,"0"))})(n)}),(0,t.jsxs)("div",{className:"d-flex justify-content-center gap-3 mb-4",children:[a?(0,t.jsx)("button",{onClick:()=>l(!1),className:"btn btn-warning btn-lg px-4 py-2",children:"⏸️ Pausar"}):(0,t.jsx)("button",{onClick:()=>{if(!h)return void alert("Por favor, selecione um t\xf3pico antes de iniciar o estudo.");f||b(new Date),l(!0)},className:"btn btn-success btn-lg px-4 py-2",children:"▶️ Iniciar"}),(0,t.jsx)("button",{onClick:()=>{l(!1),o(i?300:1500),b(null)},className:"btn btn-secondary btn-lg px-4 py-2",children:"\uD83D\uDD04 Resetar"})]}),(0,t.jsxs)("small",{className:"text-muted",children:[i?"Intervalo":"Sess\xe3o de estudo"," • ",m," sess\xf5es conclu\xeddas hoje"]})]})}),(0,t.jsxs)("div",{className:"card mb-4",children:[(0,t.jsx)("div",{className:"card-header",children:(0,t.jsx)("h5",{className:"card-title mb-0",children:"\uD83D\uDCD6 T\xf3pico Atual"})}),(0,t.jsxs)("div",{className:"card-body",children:[(0,t.jsxs)("select",{className:"form-select form-select-lg",value:h,onChange:e=>x(e.target.value),children:[(0,t.jsx)("option",{value:"",children:"Selecione um t\xf3pico para estudar"}),v.map(e=>(0,t.jsxs)("option",{value:e.id,children:[e.block.name," - ",e.name]},e.id))]}),E&&(0,t.jsxs)("div",{className:"alert alert-primary mt-3",role:"alert",children:[(0,t.jsxs)("div",{className:"small",children:[(0,t.jsx)("strong",{children:"Bloco:"})," ",E.block.name]}),(0,t.jsxs)("div",{className:"small",children:[(0,t.jsx)("strong",{children:"T\xf3pico:"})," ",E.name]})]})]})]}),(0,t.jsxs)("div",{className:"card mb-4",children:[(0,t.jsx)("div",{className:"card-header",children:(0,t.jsx)("h5",{className:"card-title mb-0",children:"\uD83D\uDCDD Notas da Sess\xe3o"})}),(0,t.jsxs)("div",{className:"card-body",children:[(0,t.jsx)("div",{className:"mb-3",children:(0,t.jsx)("textarea",{className:"form-control",rows:4,placeholder:"Anote aqui o que voc\xea estudou, d\xfavidas, insights...",value:p,onChange:e=>N(e.target.value),style:{resize:"none"}})}),(0,t.jsx)("button",{onClick:k,disabled:S||!h,className:"btn btn-primary",children:S?"⏳ Salvando...":"\uD83D\uDCBE Salvar Sess\xe3o"})]})]}),(0,t.jsxs)("div",{className:"row g-3",children:[(0,t.jsx)("div",{className:"col-md-4",children:(0,t.jsx)("div",{className:"card text-center",children:(0,t.jsxs)("div",{className:"card-body",children:[(0,t.jsx)("div",{className:"display-6 fw-bold text-primary",children:m}),(0,t.jsx)("small",{className:"text-muted",children:"Sess\xf5es Hoje"})]})})}),(0,t.jsx)("div",{className:"col-md-4",children:(0,t.jsx)("div",{className:"card text-center",children:(0,t.jsxs)("div",{className:"card-body",children:[(0,t.jsxs)("div",{className:"display-6 fw-bold text-success",children:[25*m,"min"]}),(0,t.jsx)("small",{className:"text-muted",children:"Tempo Estudado"})]})})}),(0,t.jsx)("div",{className:"col-md-4",children:(0,t.jsx)("div",{className:"card text-center",children:(0,t.jsxs)("div",{className:"card-body",children:[(0,t.jsx)("div",{className:"display-6 fw-bold text-warning",children:"0"}),(0,t.jsx)("small",{className:"text-muted",children:"Meta Di\xe1ria"})]})})})]})]})})})}function n(){return(0,t.jsx)(r.Suspense,{fallback:(0,t.jsx)("div",{children:"Carregando..."}),children:(0,t.jsx)(l,{})})}},5808:(e,s,a)=>{Promise.resolve().then(a.bind(a,3721))}},e=>{e.O(0,[441,255,358],()=>e(e.s=5808)),_N_E=e.O()}]);