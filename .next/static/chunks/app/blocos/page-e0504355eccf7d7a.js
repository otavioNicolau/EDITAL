(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[869],{4091:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>C});var l=a(5155),c=a(2115),i=a(63),t=a(3209),r=a(7003),n=a(6170),d=a(7812),o=a(1847);let m=(0,o.A)("house",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]]);var h=a(7937),x=a(6191),b=a(814),j=a(2529),N=a(6983);let g=(0,o.A)("circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);var u=a(17),v=a(1010),p=a(1360),f=a(5921),y=a(7828),w=a(5229),E=a(7220),S=a(4679),k=a(120);function C(){let e=(0,i.useRouter)(),[s,a]=(0,c.useState)([]),[o,C]=(0,c.useState)(!0),[L,A]=(0,c.useState)(""),[D,O]=(0,c.useState)("all"),[B,T]=(0,c.useState)(!1),[I,P]=(0,c.useState)(null),[R,G]=(0,c.useState)(null),[_,F]=(0,c.useState)(""),[U,M]=(0,c.useState)(""),[Y,V]=(0,c.useState)(!1),[W,z]=(0,c.useState)({});(0,c.useEffect)(()=>{q();let e=()=>{document.hidden||q()},s=()=>{q()},a=e=>{"blocks-updated"===e.key&&(q(),localStorage.removeItem("blocks-updated"))};return document.addEventListener("visibilitychange",e),window.addEventListener("focus",s),window.addEventListener("storage",a),()=>{document.removeEventListener("visibilitychange",e),window.removeEventListener("focus",s),window.removeEventListener("storage",a)}},[]);let Z=async()=>{if((()=>{let e={};return _.trim()?_.trim().length<3&&(e.name="Nome deve ter pelo menos 3 caracteres"):e.name="Nome do bloco \xe9 obrigat\xf3rio",z(e),0===Object.keys(e).length})()){V(!0);try{let e=I?"/api/blocks/".concat(I.id):"/api/blocks",s=I?"PUT":"POST";if(!(await fetch(e,{method:s,headers:{"Content-Type":"application/json"},body:JSON.stringify({name:_.trim(),description:U.trim()||void 0})})).ok)throw Error("Erro ao salvar bloco");await q(),T(!1),P(null),F(""),M(""),z({})}catch(e){console.error("Erro ao salvar bloco:",e),z({name:"Erro ao salvar bloco. Tente novamente."})}finally{V(!1)}}},$=()=>{T(!1),P(null),F(""),M(""),z({})},q=async()=>{try{let e=new Date().getTime(),s=await fetch("/api/blocks/stats?t=".concat(e),{cache:"no-cache",headers:{"Cache-Control":"no-cache",Pragma:"no-cache"}});if(s.ok){let e=await s.json();a(e)}}catch(e){console.error("Erro ao buscar blocos:",e)}finally{C(!1)}};return o?(0,l.jsx)("div",{className:"min-vh-100 bg-light p-3 p-sm-4 p-lg-5",children:(0,l.jsx)("div",{className:"container-fluid",children:(0,l.jsxs)("div",{className:"d-flex flex-column gap-4",children:[(0,l.jsx)("div",{className:"bg-secondary rounded",style:{height:"2rem",width:"33%"}}),(0,l.jsx)("div",{className:"row g-4",children:[...Array(6)].map((e,s)=>(0,l.jsx)("div",{className:"col-12 col-lg-6 col-xl-4",children:(0,l.jsx)("div",{className:"bg-secondary rounded",style:{height:"12rem"}})},s))})]})})}):(0,l.jsx)("div",{className:"min-vh-100 bg-light py-4",children:(0,l.jsxs)("div",{className:"container-fluid",children:[(0,l.jsx)("header",{className:"mb-4",children:(0,l.jsxs)("div",{className:"bg-primary rounded-3 p-4 p-md-5 text-white shadow-lg",style:{background:"linear-gradient(135deg, #4f46e5 0%, #3b82f6 50%, #8b5cf6 100%)"},children:[(0,l.jsx)("nav",{"aria-label":"breadcrumb",className:"mb-4",children:(0,l.jsxs)("ol",{className:"breadcrumb mb-0",children:[(0,l.jsx)("li",{className:"breadcrumb-item",children:(0,l.jsxs)("a",{href:"/",className:"text-white text-decoration-none d-flex align-items-center gap-1",children:[(0,l.jsx)(m,{className:"h-4 w-4"}),"Dashboard"]})}),(0,l.jsx)("li",{className:"breadcrumb-item active text-white","aria-current":"page",children:"Blocos de Estudo"})]})}),(0,l.jsxs)("div",{className:"d-flex flex-column flex-md-row justify-content-between align-items-start align-items-md-center gap-3",children:[(0,l.jsxs)("div",{className:"d-flex align-items-center gap-3",children:[(0,l.jsx)(h.A,{className:"h-8 w-8"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"h2 mb-1",children:"Blocos de Estudo"}),(0,l.jsx)("p",{className:"mb-0 opacity-75",children:"Organize seus estudos por blocos tem\xe1ticos e acompanhe seu progresso de forma eficiente e inteligente."})]})]}),(0,l.jsxs)("button",{onClick:()=>T(!0),className:"btn btn-light btn-lg rounded-3 d-flex align-items-center gap-2",children:[(0,l.jsx)(x.A,{className:"h-5 w-5"}),"Novo Bloco"]})]})]})}),(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)("h2",{className:"h4 mb-3",children:"Vis\xe3o Geral dos Estudos"}),(0,l.jsxs)("div",{className:"row g-4",children:[(0,l.jsx)("div",{className:"col-12 col-sm-6 col-lg-3",children:(0,l.jsx)("div",{className:"card border-0 shadow-sm h-100",children:(0,l.jsxs)("div",{className:"card-body text-center",children:[(0,l.jsx)("div",{className:"d-flex align-items-center justify-content-center mb-3",children:(0,l.jsx)("div",{className:"p-3 bg-primary bg-opacity-10 rounded-circle",children:(0,l.jsx)(b.A,{className:"h-6 w-6 text-primary"})})}),(0,l.jsx)("h3",{className:"h2 mb-1",children:s.length}),(0,l.jsx)("p",{className:"text-muted mb-0",children:"Total de Blocos"})]})})}),(0,l.jsx)("div",{className:"col-12 col-sm-6 col-lg-3",children:(0,l.jsx)("div",{className:"card border-0 shadow-sm h-100",children:(0,l.jsxs)("div",{className:"card-body text-center",children:[(0,l.jsx)("div",{className:"d-flex align-items-center justify-content-center mb-3",children:(0,l.jsx)("div",{className:"p-3 bg-success bg-opacity-10 rounded-circle",children:(0,l.jsx)(j.A,{className:"h-6 w-6 text-success"})})}),(0,l.jsx)("h3",{className:"h2 mb-1",children:s.filter(e=>e.topicStats.REVIEWED>0&&0===e.topicStats.PLANNED&&0===e.topicStats.STUDYING).length}),(0,l.jsx)("p",{className:"text-muted mb-0",children:"Blocos Conclu\xeddos"})]})})}),(0,l.jsx)("div",{className:"col-12 col-sm-6 col-lg-3",children:(0,l.jsx)("div",{className:"card border-0 shadow-sm h-100",children:(0,l.jsxs)("div",{className:"card-body text-center",children:[(0,l.jsx)("div",{className:"d-flex align-items-center justify-content-center mb-3",children:(0,l.jsx)("div",{className:"p-3 bg-warning bg-opacity-10 rounded-circle",children:(0,l.jsx)(N.A,{className:"h-6 w-6 text-warning"})})}),(0,l.jsx)("h3",{className:"h2 mb-1",children:s.filter(e=>e.topicStats.STUDYING>0||e.topicStats.REVIEWED>0&&(e.topicStats.PLANNED>0||e.topicStats.STUDYING>0)).length}),(0,l.jsx)("p",{className:"text-muted mb-0",children:"Em Progresso"})]})})}),(0,l.jsx)("div",{className:"col-12 col-sm-6 col-lg-3",children:(0,l.jsx)("div",{className:"card border-0 shadow-sm h-100",children:(0,l.jsxs)("div",{className:"card-body text-center",children:[(0,l.jsx)("div",{className:"d-flex align-items-center justify-content-center mb-3",children:(0,l.jsx)("div",{className:"p-3 bg-secondary bg-opacity-10 rounded-circle",children:(0,l.jsx)(g,{className:"h-6 w-6 text-secondary"})})}),(0,l.jsx)("h3",{className:"h2 mb-1",children:s.filter(e=>0===e.topicStats.STUDYING&&0===e.topicStats.REVIEWED).length}),(0,l.jsx)("p",{className:"text-muted mb-0",children:"N\xe3o Iniciados"})]})})})]})]}),(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)("h2",{className:"h4 mb-3",children:"Seus Blocos de Estudo"}),(0,l.jsx)("div",{className:"row g-4",children:s.map(s=>{var a,c,i,r,n,o;let m=(null==(a=s.itemStats)?void 0:a.DONE)||0,x=(null==(c=s.itemStats)?void 0:c.total)||0,b=x>0?Math.round(m/x*100):0;return(0,l.jsx)("div",{className:"col-12 col-lg-6 col-xl-4",children:(0,l.jsxs)(t.Zp,{className:"h-100 border-0 shadow-sm",children:[(0,l.jsxs)(t.aR,{className:"pb-3",children:[(0,l.jsxs)("div",{className:"d-flex justify-content-between align-items-start",children:[(0,l.jsxs)("div",{className:"d-flex align-items-center gap-2 flex-wrap",children:[(0,l.jsx)(d.E,{className:"".concat(["L\xedngua Portuguesa","Racioc\xednio L\xf3gico-Matem\xe1tico","Inform\xe1tica","No\xe7\xf5es de F\xedsica","\xc9tica no Servi\xe7o P\xfablico","Geopol\xedtica Brasileira","L\xedngua Estrangeira"].includes(s.name)?"bg-info text-white":"Legisla\xe7\xe3o de Tr\xe2nsito"===s.name?"bg-warning text-dark":"bg-danger text-white"),children:["L\xedngua Portuguesa","Racioc\xednio L\xf3gico-Matem\xe1tico","Inform\xe1tica","No\xe7\xf5es de F\xedsica","\xc9tica no Servi\xe7o P\xfablico","Geopol\xedtica Brasileira","L\xedngua Estrangeira"].includes(s.name)?"BLOCO 1":"Legisla\xe7\xe3o de Tr\xe2nsito"===s.name?"BLOCO 2":"BLOCO 3"}),(0,l.jsxs)(d.E,{className:"".concat(100===b?"bg-success text-white":b>0?"bg-primary text-white":"bg-secondary text-white"),children:[(0,l.jsx)(h.A,{className:"h-3 w-3 me-1"}),100===b?"Conclu\xeddo":b>0?"Em Progresso":"N\xe3o Iniciado"]})]}),(0,l.jsxs)(E.rI,{children:[(0,l.jsx)(E.ty,{className:"btn btn-light btn-sm p-2 border-0",style:{width:"32px",height:"32px"},children:(0,l.jsx)(u.A,{className:"h-4 w-4"})}),(0,l.jsxs)(E.SQ,{children:[(0,l.jsxs)(E._2,{onClick:()=>{P(s),F(s.name),M(s.description||"")},children:[(0,l.jsx)(v.A,{className:"h-4 w-4 me-2"}),"Editar"]}),(0,l.jsxs)(E._2,{onClick:()=>G(s),className:"text-danger",children:[(0,l.jsx)(p.A,{className:"h-4 w-4 me-2"}),"Excluir"]})]})]})]}),(0,l.jsx)(t.ZB,{className:"h5 mb-2",children:s.name})]}),(0,l.jsx)(t.Wu,{className:"p-4",children:(0,l.jsxs)("div",{className:"mb-4",children:[s.description&&(0,l.jsx)("div",{className:"mb-3",children:(0,l.jsx)("p",{className:"text-muted small lh-base mb-0",children:s.description})}),(0,l.jsxs)("div",{className:"mb-3",children:[(0,l.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[(0,l.jsx)("span",{className:"small fw-medium text-body",children:"Progresso"}),(0,l.jsxs)("span",{className:"small text-muted",children:[Math.round(b),"%"]})]}),(0,l.jsx)("div",{className:"progress",style:{height:"8px"},children:(0,l.jsx)("div",{className:"progress-bar transition-all ".concat(100===b?"bg-success":b>0?"bg-primary":"bg-secondary"),role:"progressbar",style:{width:"".concat(b,"%")},"aria-valuenow":b,"aria-valuemin":0,"aria-valuemax":100})})]}),(0,l.jsxs)("div",{className:"row g-2 mb-3",children:[(0,l.jsx)("div",{className:"col-3",children:(0,l.jsxs)("div",{className:"text-center p-2 bg-primary bg-opacity-10 rounded-3 border border-primary border-opacity-25",children:[(0,l.jsx)("div",{className:"h5 fw-bold text-primary mb-0",children:(null==(i=s.itemStats)?void 0:i.total)||0}),(0,l.jsx)("div",{className:"small text-primary",children:"Total"})]})}),(0,l.jsx)("div",{className:"col-3",children:(0,l.jsxs)("div",{className:"text-center p-2 bg-secondary bg-opacity-10 rounded-3 border border-secondary border-opacity-25",children:[(0,l.jsx)("div",{className:"h5 fw-bold text-secondary mb-0",children:(null==(r=s.itemStats)?void 0:r.TO_STUDY)||0}),(0,l.jsx)("div",{className:"small text-secondary",children:"Pendentes"})]})}),(0,l.jsx)("div",{className:"col-3",children:(0,l.jsxs)("div",{className:"text-center p-2 bg-warning bg-opacity-10 rounded-3 border border-warning border-opacity-25",children:[(0,l.jsx)("div",{className:"h5 fw-bold text-warning mb-0",children:(null==(n=s.itemStats)?void 0:n.IN_PROGRESS)||0}),(0,l.jsx)("div",{className:"small text-warning",children:"Em Estudo"})]})}),(0,l.jsx)("div",{className:"col-3",children:(0,l.jsxs)("div",{className:"text-center p-2 bg-success bg-opacity-10 rounded-3 border border-success border-opacity-25",children:[(0,l.jsx)("div",{className:"h5 fw-bold text-success mb-0",children:(null==(o=s.itemStats)?void 0:o.DONE)||0}),(0,l.jsx)("div",{className:"small text-success",children:"Conclu\xeddos"})]})})]}),s.topics.length>0&&(0,l.jsxs)("div",{className:"mb-3",children:[(0,l.jsx)("h6",{className:"small fw-medium text-body mb-2",children:"T\xf3picos:"}),s.topics.slice(0,3).map(e=>(0,l.jsxs)("div",{className:"d-flex align-items-center gap-2 mb-1",children:[(0,l.jsx)("div",{className:"rounded-circle ".concat("REVIEWED"===e.status?"bg-success":"STUDYING"===e.status?"bg-primary":"bg-secondary"),style:{width:"8px",height:"8px"}}),(0,l.jsx)("span",{className:"text-muted small text-truncate",children:e.name})]},e.id)),s.topics.length>3&&(0,l.jsxs)("div",{className:"text-muted",style:{fontSize:"0.75rem"},children:["+",s.topics.length-3," t\xf3picos adicionais"]})]}),(0,l.jsxs)("div",{className:"d-flex gap-2",children:[(0,l.jsxs)("button",{onClick:()=>e.push("/blocos/".concat(s.id)),className:"btn flex-fill fw-bold rounded-3 d-flex align-items-center justify-content-center gap-2 ".concat(100===b?"btn-success":b>0?"btn-primary":"btn-secondary"),children:[(0,l.jsx)(f.A,{className:"h-4 w-4"}),(0,l.jsx)("span",{children:100===b?"Revisar":b>0?"Continuar":"Iniciar"})]}),(0,l.jsx)("button",{onClick:()=>e.push("/blocos/".concat(s.id)),className:"btn btn-outline-primary rounded-3 d-flex align-items-center justify-content-center",style:{width:"48px",height:"48px"},children:(0,l.jsx)(y.A,{className:"h-4 w-4"})})]})]})})]})},s.id)})})]}),(0,l.jsx)(S.lG,{open:B||!!I,onOpenChange:e=>{e||$()},children:(0,l.jsx)(S.Cf,{className:"modal-dialog modal-dialog-centered",children:(0,l.jsxs)("div",{className:"modal-content",children:[(0,l.jsx)(S.c7,{className:"modal-header border-bottom",children:(0,l.jsx)(S.L3,{className:"modal-title h4 fw-bold text-primary d-flex align-items-center gap-2",children:I?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(v.A,{className:"h-5 w-5"}),"Editar Bloco"]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(x.A,{className:"h-5 w-5"}),"Novo Bloco"]})})}),(0,l.jsx)("div",{className:"modal-body p-4",children:(0,l.jsxs)("form",{onSubmit:e=>{e.preventDefault(),Z()},children:[(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsxs)("label",{className:"form-label fw-medium text-dark",children:["Nome do Bloco ",(0,l.jsx)("span",{className:"text-danger",children:"*"})]}),(0,l.jsx)(n.p,{value:_,onChange:e=>{F(e.target.value),W.name&&z(e=>({...e,name:void 0}))},placeholder:"Ex: L\xedngua Portuguesa, Direito Constitucional...",className:"form-control ".concat(W.name?"is-invalid":""),disabled:Y,maxLength:100}),W.name&&(0,l.jsx)("div",{className:"invalid-feedback d-block",children:(0,l.jsx)("small",{className:"text-danger",children:W.name})}),(0,l.jsxs)("small",{className:"form-text text-muted",children:[_.length,"/100 caracteres"]})]}),(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)("label",{className:"form-label fw-medium text-dark",children:"Descri\xe7\xe3o do Bloco"}),(0,l.jsx)("textarea",{value:U,onChange:e=>{M(e.target.value),W.description&&z(e=>({...e,description:void 0}))},placeholder:"Descreva brevemente o conte\xfado deste bloco de estudo...",className:"form-control ".concat(W.description?"is-invalid":""),disabled:Y,maxLength:500,rows:3}),W.description&&(0,l.jsx)("div",{className:"invalid-feedback d-block",children:(0,l.jsx)("small",{className:"text-danger",children:W.description})}),(0,l.jsxs)("small",{className:"form-text text-muted",children:[U.length,"/500 caracteres"]})]})]})}),(0,l.jsx)("div",{className:"modal-footer border-top bg-light",children:(0,l.jsxs)("div",{className:"d-flex gap-2 w-100",children:[(0,l.jsxs)(r.$,{variant:"outline",onClick:$,disabled:Y,className:"btn btn-outline-secondary flex-fill",children:[(0,l.jsx)(w.A,{className:"h-4 w-4 me-2"}),"Cancelar"]}),(0,l.jsx)(r.$,{onClick:Z,disabled:Y||!_.trim(),className:"btn flex-fill fw-bold ".concat(I?"btn-primary":"btn-success"),children:Y?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"spinner-border spinner-border-sm me-2",role:"status",children:(0,l.jsx)("span",{className:"visually-hidden",children:"Salvando..."})}),"Salvando..."]}):(0,l.jsx)(l.Fragment,{children:I?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(j.A,{className:"h-4 w-4 me-2"}),"Salvar Altera\xe7\xf5es"]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(x.A,{className:"h-4 w-4 me-2"}),"Criar Bloco"]})})})]})})]})})}),(0,l.jsx)(k.Lt,{open:!!R,onOpenChange:e=>{e||G(null)},children:(0,l.jsxs)(k.EO,{children:[(0,l.jsxs)(k.wd,{children:[(0,l.jsx)(k.r7,{children:"Excluir Bloco"}),(0,l.jsxs)(k.$v,{children:['Tem certeza que deseja excluir o bloco "',null==R?void 0:R.name,'"? Esta a\xe7\xe3o n\xe3o pode ser desfeita e todos os t\xf3picos associados tamb\xe9m ser\xe3o removidos.']})]}),(0,l.jsxs)(k.ck,{children:[(0,l.jsx)(k.Zr,{children:"Cancelar"}),(0,l.jsx)(k.Rx,{onClick:()=>{},className:"bg-red-600 hover:bg-red-700",children:"Excluir"})]})]})})]})})}},6864:(e,s,a)=>{Promise.resolve().then(a.bind(a,4091))}},e=>{e.O(0,[737,441,255,358],()=>e(e.s=6864)),_N_E=e.O()}]);